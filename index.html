<!DOCTYPE html>
<html>

<head>
	<title>Socket.io Demo</title>
	<meta charset="utf-8">
	<link rel="stylesheet" href="styles.css">
	<link rel="stylesheet" href="animate.css">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
</head>

<body>

	<div class="container-fluid">
		<h1>Socket.io Demo</h1>
		<p id="buttonCount">The button has been clicked 0 times.</p>
		<button id="toggle-dice" onclick="buttonClicked()">Click me</button>
		<!-- <div id="fb-root"></div> -->

		<div class="fb-share-button" data-href="https://www.google.com" data-layout="button_count">
		</div>

		<!-- rolling dice -->
		<div class="invisible" id="rolling-dice">
			<div id="background"></div>
			<div id="wrapper">
				<p id="point">0</p>
				<button id="play">Play</button>
				<div id="platform">
					<div id="dice">
						<div class="side front">
							<div class="dot center"></div>
						</div>
						<div class="side front inner"></div>
						<div class="side top">
							<div class="dot dtop dleft"></div>
							<div class="dot dbottom dright"></div>
						</div>
						<div class="side top inner"></div>
						<div class="side right">
							<div class="dot dtop dleft"></div>
							<div class="dot center"></div>
							<div class="dot dbottom dright"></div>
						</div>
						<div class="side right inner"></div>
						<div class="side left">
							<div class="dot dtop dleft"></div>
							<div class="dot dtop dright"></div>
							<div class="dot dbottom dleft"></div>
							<div class="dot dbottom dright"></div>
						</div>
						<div class="side left inner"></div>
						<div class="side bottom">
							<div class="dot center"></div>
							<div class="dot dtop dleft"></div>
							<div class="dot dtop dright"></div>
							<div class="dot dbottom dleft"></div>
							<div class="dot dbottom dright"></div>
						</div>
						<div class="side bottom inner"></div>
						<div class="side back">
							<div class="dot dtop dleft"></div>
							<div class="dot dtop dright"></div>
							<div class="dot dbottom dleft"></div>
							<div class="dot dbottom dright"></div>
							<div class="dot center dleft"></div>
							<div class="dot center dright"></div>
						</div>
						<div class="side back inner"></div>
						<div class="side cover x"></div>
						<div class="side cover y"></div>
						<div class="side cover z"></div>
					</div>
				</div>
			</div>
		</div>
		<!-- end of rolling dice -->


	</div>

	<script>
		(function(d, s, id) {
			var js, fjs = d.getElementsByTagName(s)[0];
			if (d.getElementById(id)) return;
			js = d.createElement(s);
			js.id = id;
			js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
			fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));
	</script>
	<script>
    var rollingDiceFunc = function(diceValue) {

      return function() {
        $('#platform').removeClass('stop').addClass('playing');
  			$('#dice')
  			setTimeout(function() {
  				$('#platform').removeClass('playing').addClass('stop');

          // can input the value for dice value
          var number = diceValue || Math.floor(Math.random() * 6) + 1;

  				var x = 0,
  					y = 20,
  					z = -20;
  				switch (number) {
  					case 1:
  						x = 0;
  						y = 20;
  						z = -20;
  						break;
  					case 2:
  						x = -100;
  						y = -150;
  						z = 10;
  						break;
  					case 3:
  						x = 0;
  						y = -100;
  						z = -10;
  						break;
  					case 4:
  						x = 0;
  						y = 100;
  						z = -10;
  						break;
  					case 5:
  						x = 80;
  						y = 120;
  						z = -10;
  						break;
  					case 6:
  						x = 0;
  						y = 200;
  						x = 10;
  						break;
  				}

  				$('#dice').css({
  					'transform': 'rotateX(' + x + 'deg) rotateY(' + y + 'deg) rotateZ(' + z + 'deg)'
  				});

  				$('#platform').css({
  					'transform': 'translate3d(0,0, 0px)'
  				});

  				$('#point').html(number);

  			}, 3000);
      };
		};

    var presetDiceValue = 3;

		$('#play').click(rollingDiceFunc(presetDiceValue));
	</script>
	<script src="/socket.io/socket.io.js"></script>
	<script>
		$.fn.extend({
			animateCss: function(animationName, callback) {
				var animationEnd = (function(el) {
					var animations = {
						animation: 'animationend',
						OAnimation: 'oAnimationEnd',
						MozAnimation: 'mozAnimationEnd',
						WebkitAnimation: 'webkitAnimationEnd',
					};

					for (var t in animations) {
						if (el.style[t] !== undefined) {
							return animations[t];
						}
					}
				})(document.createElement('div'));

				this.addClass('animated ' + animationName).one(animationEnd, function() {
					$(this).removeClass('animated ' + animationName);

					if (typeof callback === 'function') callback();
				});

				return this;
			},
		});

		var socket = io.connect();

		function buttonClicked() {
			socket.emit('clicked');

			// TODO: use this animateCss with effects.
			$("#toggle-dice").animateCss("bounce");

			$("#rolling-dice").removeClass("invisible");
		}

		//when we receive numClients, do this
		socket.on('buttonUpdate', function(data) {
			document.getElementById("buttonCount").innerHTML = 'The button has been clicked ' + data + ' times.';
		});
	</script>
</body>

</html>
